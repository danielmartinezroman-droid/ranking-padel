<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Meli Pádel Master 2026 — Ranking</title>

  <style>
    :root{
      --bg0:#070A12;
      --bg1:#0B1022;
      --line: rgba(255,255,255,.10);
      --text: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.60);
      --accent:#7C5CFF;
      --accent2:#22D3EE;
      --good:#34D399;
      --warn:#FBBF24;
      --bad:#FB7185;
      --gold: #FFD700;
      --radius: 18px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: var(--sans);
      color:var(--text);
      background:
        linear-gradient(90deg, var(--bg1) 0%, var(--bg1) 50%, #000000 85%, #000000 100%),
        radial-gradient(900px 450px at 15% 10%, rgba(124,92,255,.26), transparent 60%),
        radial-gradient(900px 450px at 50% 20%, rgba(34,211,238,.15), transparent 55%),
        radial-gradient(900px 450px at 30% 90%, rgba(52,211,153,.10), transparent 55%);
      background-color: #000000;
      min-height:100vh;
    }

    .main-container {
      display: flex;
      max-width: 1500px;
      margin: 0 auto;
      padding: 28px 18px 40px;
    }

    .wrap{ 
      flex: 1;
      max-width: 980px;
      margin: 0 auto;
    }

    /* ===== Sidebar de Video ===== */
    .video-sidebar {
      width: 380px;
      flex-shrink: 0;
      position: fixed;
      right: 20px;
      top: 50%;
      transform: translateY(-50%);
      height: fit-content;
      z-index: 100;
    }

    .video-wrapper {
      position: relative;
      width: 100%;
      height: 600px;
      overflow: hidden;
      background: #000000;
      border-radius: 20px;
      box-shadow: 
        0 0 80px 40px rgba(0,0,0,0.9),
        0 0 150px 80px rgba(0,0,0,0.6);
    }

    .video-wrapper video {
      width: 100%;
      height: 100%;
      object-fit: contain;
      object-position: center;
      position: absolute;
      top: 0;
      left: 0;
      opacity: 0;
      transition: opacity 0.4s ease, transform 0.3s ease;
      pointer-events: none;
      transform-origin: center center;
    }

    .video-wrapper video.active {
      opacity: 1;
    }

    header{
      display:flex; gap:14px;
      justify-content:space-between; align-items:flex-end;
      flex-wrap:wrap; margin-bottom: 16px;
    }

    .title{ display:flex; flex-direction:column; gap:6px; }
    h1{ font-size: 22px; margin:0; letter-spacing:.2px; }
    .sub{ color:var(--muted); font-size: 13px; }

    .chips{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
    .chip{
      border:1px solid var(--line);
      background: rgba(255,255,255,.04);
      padding:10px 12px; border-radius: 999px;
      display:flex; gap:8px; align-items:center;
      font-size: 13px; color:var(--muted);
      backdrop-filter: blur(10px);
      box-shadow: 0 10px 30px rgba(0,0,0,.2);
    }
    .chip b{ color:var(--text); font-weight:600; }
    .dot{
      width:10px;height:10px;border-radius:50%;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      box-shadow: 0 0 0 4px rgba(124,92,255,.12);
      animation: dotPulse 2s ease-in-out infinite;
    }

    @keyframes dotPulse {
      0%, 100% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.2); opacity: 0.7; }
    }

    /* ===== Progress Chip ===== */
    .chip.progress-chip {
      flex-direction: column;
      align-items: flex-start;
      gap: 6px;
      padding: 10px 14px;
      min-width: 180px;
    }

    .progress-chip .progress-header {
      display: flex;
      justify-content: space-between;
      width: 100%;
      align-items: center;
    }

    .progress-chip .progress-bar {
      width: 100%;
      height: 6px;
      background: rgba(255,255,255,.10);
      border-radius: 999px;
      overflow: hidden;
    }

    .progress-chip .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--accent), var(--accent2));
      border-radius: 999px;
      transition: width 1.5s cubic-bezier(.2,.9,.2,1);
      box-shadow: 0 0 10px rgba(124,92,255,.5);
    }

    /* ===== Podio Top 3 ===== */
    .podium{
      display:grid;
      grid-template-columns: 1fr 1.15fr 1fr;
      gap:12px;
      margin-top: 14px;
      margin-bottom: 12px;
    }

    .podiumCard{
      border:1px solid rgba(255,255,255,.12);
      background: linear-gradient(180deg, rgba(255,255,255,.09), rgba(255,255,255,.04));
      border-radius: 20px;
      padding: 14px;
      box-shadow: 0 18px 55px rgba(0,0,0,.45);
      backdrop-filter: blur(10px);
      position: relative;
      overflow:hidden;
      cursor: pointer;
      transition: transform 0.2s ease, border-color 0.2s ease, background 0.2s ease;
      opacity: 0;
      animation: podiumEnter 600ms cubic-bezier(.2,.9,.2,1) forwards;
    }

    .podiumCard:nth-child(1) { animation-delay: 150ms; }
    .podiumCard:nth-child(2) { animation-delay: 0ms; }
    .podiumCard:nth-child(3) { animation-delay: 300ms; }

    @keyframes podiumEnter {
      from { 
        opacity: 0; 
        transform: translateY(30px) scale(0.95); 
      }
      to { 
        opacity: 1; 
        transform: translateY(0) scale(1); 
      }
    }

    .podiumCard:hover {
      transform: translateY(-3px);
      border-color: rgba(124,92,255,.45);
      background: linear-gradient(180deg, rgba(124,92,255,.15), rgba(255,255,255,.06));
    }

    /* ===== GLOW PULSANTE #1 ===== */
    .podiumCard.rank1 {
      border-color: rgba(255,215,0,.25);
      animation: podiumEnter 600ms cubic-bezier(.2,.9,.2,1) forwards, 
                 goldGlow 3s ease-in-out infinite 600ms;
    }

    @keyframes goldGlow {
      0%, 100% { 
        box-shadow: 
          0 18px 55px rgba(0,0,0,.45),
          0 0 20px rgba(255,215,0,.15),
          0 0 40px rgba(255,215,0,.08),
          inset 0 0 30px rgba(255,215,0,.03);
      }
      50% { 
        box-shadow: 
          0 18px 55px rgba(0,0,0,.45),
          0 0 35px rgba(255,215,0,.30),
          0 0 70px rgba(255,215,0,.15),
          inset 0 0 50px rgba(255,215,0,.06);
      }
    }

    .podiumCard.rank1:hover {
      border-color: rgba(255,215,0,.50);
      background: linear-gradient(180deg, rgba(255,215,0,.12), rgba(255,255,255,.06));
    }

    .podiumCard::before{
      content:"";
      position:absolute;
      inset:-2px;
      border-radius: 22px;
      opacity:.55;
      filter: blur(18px);
      background: radial-gradient(circle at 20% 15%, rgba(124,92,255,.45), transparent 55%),
                  radial-gradient(circle at 80% 25%, rgba(34,211,238,.32), transparent 55%);
    }

    .podiumCard.rank1::before {
      background: radial-gradient(circle at 20% 15%, rgba(255,215,0,.50), transparent 55%),
                  radial-gradient(circle at 80% 25%, rgba(255,180,0,.35), transparent 55%);
    }

    .podiumCard::after{
      content: attr(data-rank);
      position:absolute;
      right: 14px;
      bottom: -10px;
      font-family: var(--mono);
      font-weight: 900;
      font-size: 96px;
      letter-spacing: -0.06em;
      line-height: 1;
      opacity: .10;
      pointer-events:none;
      z-index: 0;
    }
    .podiumCard.rank1::after{ color: rgba(255,215,0,.90); }
    .podiumCard.rank2::after{ color: rgba(203,213,225,.90); }
    .podiumCard.rank3::after{ color: rgba(205,127,50,.90); }

    .podiumTop{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:10px;
      position:relative;
      z-index:1;
      margin-bottom: 10px;
    }

    .podiumAvatar{
      width: 64px;
      height: 64px;
      border-radius: 999px;
      overflow: hidden;
      border: 2px solid rgba(255,255,255,.22);
      background: rgba(255,255,255,.06);
      box-shadow: 0 18px 45px rgba(0,0,0,.35);
      flex: 0 0 auto;
      transition: transform 0.2s ease, border-color 0.2s ease;
    }
    .podiumCard:hover .podiumAvatar {
      transform: scale(1.05);
      border-color: var(--accent2);
    }
    .podiumCard.rank1:hover .podiumAvatar {
      border-color: var(--gold);
    }
    .podiumAvatar img{
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
    }

    .podiumBig{ transform: translateY(-6px); }
    .podiumCard.rank1 .podiumAvatar{
      width: 74px;
      height: 74px;
      border-color: rgba(255,215,0,.35);
      box-shadow: 0 0 0 6px rgba(255,215,0,.08), 0 22px 60px rgba(0,0,0,.40);
    }

    .podiumMedal{
      width: 42px;
      height: 42px;
      border-radius: 999px;
      border:1px solid rgba(255,255,255,.18);
      display:grid;
      place-items:center;
      font-family: var(--mono);
      font-weight: 900;
      position:relative;
      z-index:1;
    }
    .medalGold{
      background: radial-gradient(circle at 30% 30%, rgba(255,215,0,.55), rgba(255,255,255,.08) 60%);
      box-shadow: 0 0 0 4px rgba(255,215,0,.08), 0 25px 60px rgba(255,215,0,.12);
    }
    .medalSilver{
      background: radial-gradient(circle at 30% 30%, rgba(203,213,225,.55), rgba(255,255,255,.08) 60%);
      box-shadow: 0 0 0 4px rgba(203,213,225,.10), 0 25px 60px rgba(203,213,225,.10);
    }
    .medalBronze{
      background: radial-gradient(circle at 30% 30%, rgba(205,127,50,.55), rgba(255,255,255,.08) 60%);
      box-shadow: 0 0 0 4px rgba(205,127,50,.10), 0 25px 60px rgba(205,127,50,.10);
    }

    .podiumName{ position:relative; z-index:1; display:flex; flex-direction:column; gap:6px; }
    .podiumName strong{ 
      font-size: 15px; 
      letter-spacing:.2px; 
      transition: color 0.2s ease;
    }
    .podiumCard:hover .podiumName strong {
      color: var(--accent2);
    }
    .podiumCard.rank1:hover .podiumName strong {
      color: var(--gold);
    }
    .podiumMeta{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      align-items:center;
      color: rgba(255,255,255,.60);
      font-size: 12px;
    }

    .points-badge{
      font-family: var(--mono);
      font-size: 13px;
      font-weight: 700;
      padding: 6px 12px;
      border-radius: 999px;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      color: white;
      box-shadow: 0 4px 15px rgba(124,92,255,.35);
    }

    .podiumCard.rank1 .points-badge {
      background: linear-gradient(135deg, var(--gold), #FFA500);
      box-shadow: 0 4px 15px rgba(255,215,0,.35);
    }

    /* ===== Separador ===== */
    .section-divider {
      display: flex;
      align-items: center;
      gap: 16px;
      margin: 24px 0 18px;
      opacity: 0;
      animation: fadeIn 500ms ease forwards 400ms;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .section-divider .line {
      flex: 1;
      height: 1px;
      background: linear-gradient(90deg, transparent, rgba(124,92,255,.4), rgba(34,211,238,.3), transparent);
    }

    .section-divider .label {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 2px;
      color: var(--muted);
      font-weight: 600;
      white-space: nowrap;
    }

    @media (max-width: 860px){
      .podium{ grid-template-columns: 1fr; }
      .podiumBig{ transform:none; }
    }

    /* ===== Lista ===== */
    #list{ display:flex; flex-direction:column; gap:12px; }

    .card{
      position: relative; overflow: hidden;
      border:1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,.04));
      border-radius: var(--radius);
      padding: 14px;
      box-shadow: 0 12px 40px rgba(0,0,0,.35);
      backdrop-filter: blur(10px);
      transition: transform .15s ease, background .2s ease, border-color .2s ease;
      display:flex; justify-content:space-between; gap:14px; align-items:center;
      opacity: 0;
      animation: enterCard 520ms cubic-bezier(.2,.9,.2,1) both;
      cursor: pointer;
    }
    .card:hover{
      transform: translateY(-2px);
      border-color: rgba(124,92,255,.35);
      background: linear-gradient(180deg, rgba(124,92,255,.12), rgba(255,255,255,.04));
    }

    .card::before{
      content:"";
      position:absolute; top:-40%; left:-60%;
      width: 60%; height: 200%;
      background: linear-gradient(120deg,
        transparent 0%,
        rgba(255,255,255,.10) 40%,
        rgba(255,255,255,.18) 50%,
        rgba(255,255,255,.10) 60%,
        transparent 100%);
      transform: rotate(18deg);
      opacity: 0; transition: opacity .2s ease;
      pointer-events:none;
    }
    .card:hover::before{ opacity: 1; animation: shine 900ms ease forwards; }

    @keyframes shine{
      from { transform: translateX(0) rotate(18deg); }
      to   { transform: translateX(260%) rotate(18deg); }
    }
    @keyframes enterCard{
      from { opacity: 0; transform: translateY(10px); }
      to   { opacity: 1; transform: translateY(0); }
    }

    .left{ display:flex; align-items:center; gap:12px; min-width: 0; flex: 1 1 auto; }
    .rank{
      font-family: var(--mono);
      color: rgba(255,255,255,.70);
      width: 36px; text-align:center;
      padding:7px 10px;
      border:1px solid rgba(255,255,255,.10);
      border-radius: 999px;
      background: rgba(0,0,0,.18);
      flex: 0 0 auto;
    }

    .avatar{
      width: 44px; height: 44px; border-radius: 999px;
      position: relative; overflow: hidden; flex: 0 0 auto;
      border:1px solid rgba(255,255,255,.18);
      background: rgba(255,255,255,.06);
      transition: transform .25s ease, box-shadow .25s ease, border-color .25s ease;
    }
    .avatar img{
      width:100%; height:100%; object-fit:cover; display:block;
      transform: scale(1);
      transition: transform .35s ease, filter .35s ease;
      position:relative; z-index:1;
    }
    .avatar::after{
      content:"";
      position:absolute; inset:-2px; border-radius: 999px;
      background: conic-gradient(from 180deg, var(--accent), var(--accent2), var(--good), var(--accent));
      filter: blur(10px);
      opacity: 0; transition: opacity .25s ease;
      z-index: 0;
    }
    .card:hover .avatar{
      transform: translateY(-1px) scale(1.05);
      border-color: rgba(34,211,238,.55);
      box-shadow: 0 0 0 4px rgba(124,92,255,.14), 0 18px 40px rgba(0,0,0,.35);
    }
    .card:hover .avatar::after{ opacity: .85; }
    .card:hover .avatar img{ transform: scale(1.12); filter: saturate(1.15) contrast(1.05); }

    .nameBlock{ min-width:0; display:flex; flex-direction:column; gap:6px; flex: 1 1 auto; }
    .nameLine{ display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
    .nameLine strong{ 
      color:var(--text); 
      font-weight:750; 
      font-size: 14px; 
      transition: color 0.2s ease;
    }
    .card:hover .nameLine strong {
      color: var(--accent2);
    }

    .badge{
      font-family: var(--mono);
      font-size: 12px;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.16);
      color: rgba(255,255,255,.78);
    }
    .badge.good{ border-color: rgba(52,211,153,.35); color: rgba(52,211,153,.95); }
    .badge.warn{ border-color: rgba(251,191,36,.35); color: rgba(251,191,36,.95); }
    .badge.bad{ border-color: rgba(251,113,133,.35); color: rgba(251,113,133,.95); }

    .badge.elite{ border-color: rgba(52,211,153,.35); color: rgba(52,211,153,.95); }
    .badge.fight{ border-color: rgba(251,191,36,.35); color: rgba(251,191,36,.95); }
    .badge.comeback{ border-color: rgba(251,113,133,.35); color: rgba(251,113,133,.95); }

    .card.elite:hover{ border-color: rgba(52,211,153,.35); }
    .card.fight:hover{ border-color: rgba(251,191,36,.35); }
    .card.comeback:hover{ border-color: rgba(251,113,133,.35); }

    .bar{
      width: min(420px, 100%);
      height: 10px;
      border-radius: 999px;
      background: rgba(255,255,255,.08);
      border: 1px solid rgba(255,255,255,.10);
      overflow:hidden;
    }
    .bar > span{
      display:block; height:100%;
      width: var(--w);
      background: linear-gradient(90deg, var(--accent), var(--accent2));
      border-radius: 999px;
      box-shadow: 0 0 20px rgba(34,211,238,.22);
      transform-origin: left;
      animation: fill 900ms cubic-bezier(.2,.9,.2,1) both;
    }
    @keyframes fill{ from { transform: scaleX(0); } to { transform: scaleX(1); } }

    .right{ display:flex; gap:10px; flex-wrap:wrap; justify-content:flex-end; align-items:center; flex: 0 0 auto; }
    .pill{
      border:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.14);
      border-radius: 999px;
      padding: 8px 10px;
      font-size: 12px;
      color: rgba(255,255,255,.70);
      display:flex; gap:8px; align-items:center;
      font-variant-numeric: tabular-nums;
      white-space:nowrap;
    }
    .pill b{ color: rgba(255,255,255,.92); font-weight:700; }
    
    .pill.points{
      background: linear-gradient(135deg, rgba(124,92,255,.25), rgba(34,211,238,.20));
      border-color: rgba(124,92,255,.45);
    }
    .pill.points b{
      color: var(--accent2);
      font-size: 14px;
    }

    .footer{
      margin-top: 16px;
      color: rgba(255,255,255,.55);
      font-size: 12px;
      display:flex;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
    }

    /* ===== Count-up ===== */
    .count-up {
      display: inline-block;
    }

    /* ===== MOBILE ===== */
    @media (max-width: 1100px){
      .main-container {
        flex-direction: column;
      }
      .video-sidebar {
        position: relative;
        width: 100%;
        right: auto;
        top: auto;
        transform: none;
        order: 2;
        margin-top: 30px;
      }
      .video-wrapper {
        height: 400px;
        max-width: 350px;
        margin: 0 auto;
      }
      .wrap {
        max-width: 100%;
        order: 1;
      }
    }

    @media (max-width: 720px){
      .podiumCard{ padding: 14px; }
      .podiumCard::after{ font-size: 72px; bottom: -6px; }
      .podiumAvatar{ width: 58px; height: 58px; }
      .podiumCard.rank1 .podiumAvatar{ width: 66px; height: 66px; }

      .card{
        flex-direction: column;
        align-items: stretch;
        gap: 12px;
      }
      .left{ width: 100%; }
      .bar{ width: 100%; }
      .right{
        width: 100%;
        justify-content: flex-start;
      }

      .chips{ width: 100%; }
      .chip{
        flex: 1 1 auto;
        justify-content: center;
      }
      
      .chip.progress-chip {
        min-width: unset;
      }
    }
  </style>
</head>

<body>
  <div class="main-container">
    <div class="wrap">
      <header>
        <div class="title">
          <h1>Meli Pádel Master 2026 — Ranking</h1>
          <div class="sub">Ordenado por puntos (sets ganados). La barra muestra el rendimiento (%) como referencia.</div>
        </div>
        <div class="chips">
          <div class="chip"><span class="dot"></span> Estado: <b>En curso</b></div>
          <div class="chip">Sets jugados: <b><span id="totalSets" class="count-up">0</span>/45</b></div>
          <div class="chip progress-chip">
            <div class="progress-header">
              <span>Avance del torneo</span>
              <b><span id="progressPercent" class="count-up">0</span>%</b>
            </div>
            <div class="progress-bar">
              <div class="progress-fill" id="progressFill" style="width: 0%"></div>
            </div>
          </div>
        </div>
      </header>

      <div id="podium" class="podium"></div>
      
      <!-- Separador -->
      <div class="section-divider">
        <div class="line"></div>
        <span class="label">Clasificación General</span>
        <div class="line"></div>
      </div>
      
      <div id="list"></div>

      <div class="footer">
        <div>Tip: Ganas el torneo cuando dejas de perseguir el trofeo y empiezas a dominar el proceso.</div>
        <div>Orden: puntos → rendimiento → nombre.</div>
      </div>
    </div>

    <!-- Sidebar de Video -->
    <aside class="video-sidebar">
      <div class="video-wrapper" id="videoWrapper">
        <video id="video-dani-a" muted loop playsinline preload="auto">
          <source src="img/Daniel Aguayo.mp4" type="video/mp4">
        </video>
        <video id="video-dani-m" muted loop playsinline preload="auto">
          <source src="img/Daniel Martinez.mp4" type="video/mp4">
        </video>
        <video id="video-esteban" muted loop playsinline preload="auto">
          <source src="img/Esteban Pino.mp4" type="video/mp4">
        </video>
        <video id="video-feli" muted loop playsinline preload="auto">
          <source src="img/Felipe Rivero.mp4" type="video/mp4">
        </video>
        <video id="video-ric" muted loop playsinline preload="auto">
          <source src="img/Ricardo Bernstein.mp4" type="video/mp4">
        </video>
        <video id="video-yuri" muted loop playsinline preload="auto">
          <source src="img/Yuri Jimenez.mp4" type="video/mp4">
        </video>
      </div>
    </aside>
  </div>

  <script>
    // ============================
    // DATOS DE JUGADORES
    // ============================
    const players = [
      { name: "Dani M.", sets: 3, won: 3, lost: 0, avatar: "img/dani-m.jpg", videoId: "dani-m", videoScale: 1.0 },
      { name: "Dani A.", sets: 3, won: 1, lost: 2, avatar: "img/dani-a.jpg", videoId: "dani-a", videoScale: 1.0 },
      { name: "Yuri", sets: 6, won: 2, lost: 4, avatar: "img/yuri.jpg", videoId: "yuri", videoScale: 1.0 },
      { name: "Feli", sets: 6, won: 2, lost: 4, avatar: "img/feli.jpg", videoId: "feli", videoScale: 1.0 },
      { name: "Ric", sets: 3, won: 1, lost: 2, avatar: "img/ric.jpg", videoId: "ric", videoScale: 0.9 },
      { name: "Esteban", sets: 3, won: 3, lost: 0, avatar: "img/esteban.jpg", videoId: "esteban", videoScale: 0.9 }
    ];

    const TOTAL_TOURNAMENT_SETS = 45;
    const SETS_PLAYED = 6;
    // ============================

    let currentVideo = null;

    // ============================
    // COUNT-UP ANIMATION
    // ============================
    function animateCountUp(element, target, duration = 1500, suffix = '') {
      const start = 0;
      const startTime = performance.now();
      
      function update(currentTime) {
        const elapsed = currentTime - startTime;
        const progress = Math.min(elapsed / duration, 1);
        
        // Easing function (ease-out)
        const easeOut = 1 - Math.pow(1 - progress, 3);
        const current = Math.round(start + (target - start) * easeOut);
        
        element.textContent = current + suffix;
        
        if (progress < 1) {
          requestAnimationFrame(update);
        }
      }
      
      requestAnimationFrame(update);
    }

    function showPlayerVideo(videoId) {
      if (currentVideo) {
        currentVideo.pause();
        currentVideo.currentTime = 0;
        currentVideo.classList.remove('active');
        currentVideo.style.transform = '';
      }
      
      const video = document.getElementById(`video-${videoId}`);
      if (video) {
        const player = players.find(p => p.videoId === videoId);
        const scale = player?.videoScale || 1.0;
        
        video.classList.add('active');
        video.style.transform = `scale(${scale})`;
        video.currentTime = 0;
        video.play().catch(e => console.log('Video error:', e));
        currentVideo = video;
      }
    }

    function hideAllVideos() {
      if (currentVideo) {
        currentVideo.pause();
        currentVideo.currentTime = 0;
        currentVideo.classList.remove('active');
        currentVideo.style.transform = '';
        currentVideo = null;
      }
    }

    function addCardHoverEvents(cardElement, videoId) {
      cardElement.addEventListener('mouseenter', () => showPlayerVideo(videoId));
      cardElement.addEventListener('mouseleave', hideAllVideos);
    }

    const perf = p => (Number(p.sets) > 0 ? Math.round((Number(p.won) / Number(p.sets)) * 100) : 0);
    const points = p => Number(p.won) || 0;
    const badgeClass = pct => pct >= 67 ? "good" : pct >= 34 ? "warn" : "bad";

    function medalLabel(pct){
      if (pct >= 67) return { text: "Elite", cls: "elite" };
      if (pct >= 34) return { text: "En pelea", cls: "fight" };
      return { text: "Remontar", cls: "comeback" };
    }

    function renderPodium(sorted){
      const podium = document.getElementById("podium");
      if (!podium) return;

      const top3 = sorted.slice(0,3);
      const order = [1,0,2];
      const mapped = order.map(i => top3[i]).filter(Boolean);

      podium.innerHTML = mapped.map(p => {
        const pct = perf(p);
        const pts = points(p);
        const m = medalLabel(pct);

        const realRank = (p === top3[0]) ? 1 : (p === top3[1]) ? 2 : 3;
        const big = realRank === 1 ? "podiumBig" : "";
        const medalClass = realRank === 1 ? "medalGold" : realRank === 2 ? "medalSilver" : "medalBronze";
        const rankClass = realRank === 1 ? "rank1" : realRank === 2 ? "rank2" : "rank3";

        return `
          <div class="podiumCard ${big} ${rankClass}" data-rank="${realRank}" data-video-id="${p.videoId}">
            <div class="podiumTop">
              <div class="podiumAvatar">
                <img src="${p.avatar}" alt="${p.name}" onerror="this.style.display='none'">
              </div>
              <span class="podiumMedal ${medalClass}">${realRank}</span>
            </div>

            <div class="podiumName">
              <strong>${p.name}</strong>
              <div class="podiumMeta">
                <span class="points-badge"><span class="count-up-points" data-target="${pts}">0</span> pts</span>
                <span class="badge ${badgeClass(pct)}">${pct}%</span>
                <span class="badge ${m.cls}">${m.text}</span>
                <span style="font-family: var(--mono); opacity:.75;">${p.won}G · ${p.lost}P · ${p.sets} sets</span>
              </div>
              <div class="bar"><span style="--w:${pct}%"></span></div>
            </div>
          </div>
        `;
      }).join("");

      podium.querySelectorAll('.podiumCard').forEach(card => {
        addCardHoverEvents(card, card.dataset.videoId);
      });

      // Animate points in podium
      podium.querySelectorAll('.count-up-points').forEach(el => {
        const target = parseInt(el.dataset.target);
        setTimeout(() => animateCountUp(el, target, 1200), 300);
      });
    }

    const sorted = [...players].sort((a,b) =>
      points(b) - points(a) || perf(b) - perf(a) || String(a.name || "").localeCompare(String(b.name || ""))
    );

    // Animate header stats
    const progressPercent = Math.round((SETS_PLAYED / TOTAL_TOURNAMENT_SETS) * 100);
    
    setTimeout(() => {
      animateCountUp(document.getElementById("totalSets"), SETS_PLAYED, 1500);
      animateCountUp(document.getElementById("progressPercent"), progressPercent, 1500);
      
      // Animate progress bar
      setTimeout(() => {
        document.getElementById("progressFill").style.width = progressPercent + "%";
      }, 100);
    }, 200);

    renderPodium(sorted);

    const list = document.getElementById("list");
    list.innerHTML = "";

    sorted.forEach((p, idx) => {
      const pct = perf(p);
      const pts = points(p);
      const m = medalLabel(pct);

      const card = document.createElement("div");
      card.className = "card " + m.cls;
      card.style.animationDelay = (idx * 70 + 500) + "ms";
      card.dataset.videoId = p.videoId;

      card.innerHTML = `
        <div class="left">
          <div class="rank">#${idx+1}</div>
          <div class="avatar">
            <img src="${p.avatar}" alt="${p.name}" onerror="this.style.display='none'">
          </div>
          <div class="nameBlock">
            <div class="nameLine">
              <strong>${p.name}</strong>
              <span class="points-badge"><span class="count-up-points" data-target="${pts}">0</span> pts</span>
              <span class="badge ${badgeClass(pct)}">${pct}%</span>
              <span class="badge ${m.cls}">${m.text}</span>
              <span style="color: rgba(255,255,255,.55); font-size:12px; font-family: var(--mono);">
                ${p.won}G · ${p.lost}P
              </span>
            </div>
            <div class="bar"><span style="--w:${pct}%"></span></div>
          </div>
        </div>

        <div class="right">
          <div class="pill points">Puntos: <b class="count-up-points" data-target="${pts}">0</b></div>
          <div class="pill">Sets: <b>${p.sets}</b></div>
          <div class="pill">Ganados: <b>${p.won}</b></div>
          <div class="pill">Perdidos: <b>${p.lost}</b></div>
        </div>
      `;

      addCardHoverEvents(card, p.videoId);

      list.appendChild(card);
    });

    // Animate all points in list after cards appear
    setTimeout(() => {
      list.querySelectorAll('.count-up-points').forEach((el, i) => {
        const target = parseInt(el.dataset.target);
        setTimeout(() => animateCountUp(el, target, 800), i * 50);
      });
    }, 700);
  </script>
</body>
</html>



